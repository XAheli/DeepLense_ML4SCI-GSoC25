<div align="center">
  
# DeepLense: ML4SCI GSoC 2025 Evaluation Tasks and Proposal
  
<a href="https://gist.github.com/XAheli/8391f6bdae596e82fe0260c215c5ab8c" target="_blank"><img src="https://img.shields.io/badge/Google%20Summer%20of%20Code-2025-fbbc05?style=flat&logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAALVBMVEVHcEz7vQD7vQD8vQD7vQD8vQD7vQD8vQD8vQD7vQD7vQD8vQD7vQD7vQD7vQAgxtLpAAAADnRSTlMAZvVQ6QrVPhl6oSmHvzL6LQUAAASGSURBVHjatdnZdusgDAVQELMY%2Fv9zb2%2Bwc%2BIKDzQLvTXB3gYBFqmaDVeKU4sCBlFyy43WqLjlBpR1BpR1BpR1xjoFxmIFBpSVBpSVBpSVBpSVBpQ1xvdK1oPgblhfOWltjNaJq7ddYT2IfImYJqMDrENUChGDZn%2FWQ%2FMHxBcD4BMyBc5XCHkNQTq60vfIgXAx5xByju6T8V8itsT3%2FUPi6r39Ce8rp%2FCWYrHfIDXs95FZJs%2FvTob6Z4T2buQE4eikvHeG%2FoZY7TpRfDsNWzrjtP0L4s12NYhh%2BO1ZjJ9HfOjdYGo3QZx7YvwEAgOPdx3eQJlArMFA3wXSZ%2BwMQvplJGoPY6sqNU0gxcGYUVx5jtSIx3oS6HysTxEbMMDPAmkM9iFSXnPXt8nwuQ%2FYI8TH%2F425TQe7%2FnBPEH2bECI6T4t%2Bgvh4N1istR50FJdeIX1Ek%2FqJdGGQOWmAa4u7rn18vuuIzUq52gbxvpiSuzIau%2BuO9FUUfTvvCjcoQ4MMltRnEOqF0pdD%2FwiBZWxoqGCn8r2VGKIUCHOoTyHK2g7y1bsJRRqNe3%2FlXv5GbNhWEWXxbsf1UITRF4kYcM4KiI%2FbeFIevNNq7P2EIg0bVL%2BfqCcyYV2rbDdExWSPjUPPGBRh9JTowTscW0Dqf%2BwLXGmPthgKKMJo1f1OSQ29hf1Mbdlmg5NFV1H7KoICA3mruIQ4vl4TTFhvuAlxxrdb1J55KMJoBatEPCv6mr3sJzK%2F9RQKDAx49Ji5ctSLwsxAxgyuiduOAeVtIG14zppPKtAka9lcMZz71IHyNoAcCpvIx6UfxGLleCim3ggUpe0dQhe7I86mWvQERZmCIocryAqPsdYOSQlVIjCgyMRbLSaXxi3GD4LEw4AipzCyyvS5a5ThMpJTGAYUuQljhiWL53R11FN5BxhQsK0UWbE747E7evGV2FaEAUWmDave0H4LQxg6nErl1IEBBRdmOzjkBPpdqFB%2BpUtUGb0tDKloZP44hQLthQoDwXYiXlowpMJIymExdARL8SViYzymhGEMFR%2FR3cOyNoRCpQcZFu1s6AsNhlQuSiJP%2B1Kk90dNRHW9BYyhwlszhNgdb05CjmGcKDb3DotAoYIYV9wWxjDSZcHNmN%2Fj0KpPm3R7dMjq7HlrSokvjIqjww3SEhb4XJDpg3CLvM9%2BPG%2FMHOcaOwzYRFScNe8QHJb9nOEDhvkGwV48eZC3BgfzWwSHZaXthKEVMvkMaQnKhKESzSCkJ37uQqlJ7RmCIcbr%2By5qUEjiIwQK3q4yZKHqYDxEUIo4U6%2BNahxKr0kEZwv8HC%2BDqo69UaI2ieBAujN2RNhOoPybQjBr9oNSKNXSoQ%2B2luCUQuk1iSCIg9oiZl24Vv8TtXLROaotAtO3%2F9ooWSFcjDnH6BQio2SZQSRz%2FpsPfsifQ2RY1tmNBM3oxQRCbRjkOZn%2FEACT2J%2B1vkZiGESyG1SZS%2FqJ1wTogE1hEFHNh9yNCbvvREwqCwwoawwoKw0oKw0oKw0oKw0oKw0oKw0oMFYqMFYqMFYqMBYq88Y%2FxB7wiOJRvWkAAAAASUVORK5CYII%3D" /></a>

![GitHub stars](https://img.shields.io/github/stars/XAheli/DeepLense_ML4SCI-GSoC25?style=social)
![GitHub forks](https://img.shields.io/github/forks/XAheli/DeepLense_ML4SCI-GSoC25?style=social)
![PyTorch](https://img.shields.io/badge/PyTorch-%23EE4C2C.svg?&logo=PyTorch)
![Deep Learning](https://img.shields.io/badge/Deep%20Learning-%230077B5.svg?logo=deep-learning)
![Computer Vision](https://img.shields.io/badge/Computer%20Vision-%23A100FF.svg?logo=OpenCV)


*A dedicated submission repository for the Google Summer of Code 2025 [ML4SCI DeepLense Projects](https://ml4sci.org/gsoc/projects/2025/project_DEEPLENSE.html).*
  
</div>

<br>

## ðŸ”­ Overview

The DeepLense project analyzes gravitational lensing data, which is crucial for understanding dark matter distribution in the universe. Gravitational lensing occurs when massive objects bend light from distant sources, creating distinctive visual patterns that can be analyzed to infer cosmic structures.

This repository demonstrates implementations of three key machine learning tasks related to gravitational lensing analysis:
1. Classification of lensing images based on substructure types
2. Detection of gravitational lensing events in highly imbalanced datasets
3. Generation of synthetic gravitational lensing images using advanced generative models

## ðŸš€ Tasks Implemented

### Task 1: Multi-Class Classification

**Objective**: Classify strong gravitational lensing images into three categories (no substructure, subhalo substructure, vortex substructure).

**Approach**:
- Implemented DenseNet161 and DenseNet201 architectures
- Created an ensemble model combining multiple architectures
- Conducted comprehensive evaluation with confusion matrices and ROC curves

**Key Results**:
- Ensemble model achieved 91-92% overall accuracy
- AUC scores of 0.94-0.95
- F1 scores ranging from 0.90-0.91 across all classes

![Ensemble Model Confusion Matrix](https://github.com/XAheli/DeepLense_ML4SCI-GSoC25/blob/main/Common%20Test%20I/Images/Ensemble/download.png)


### Task 2: Lens Finding

**Objective**: Detect gravitational lensing events in highly imbalanced datasets (up to 1:100 ratio between lens and non-lens classes).

**Approach**:
- Evaluated multiple architectures (ResNet18, EfficientNet, MobileViT)
- Implemented techniques for handling extreme class imbalance:
  - Aggressive data augmentation of minority class
  - Class weighting in loss function
  - Threshold optimization for F1-score maximization
  
**Key Results**:
- ResNet18 emerged as best architecture with:
  - AUC score of 0.98
  - F1 score of 0.21
  - Recall of 0.95 for the rare lens class

![Best Model ROC](https://github.com/XAheli/DeepLense_ML4SCI-GSoC25/blob/main/Specific%20Test%20II%20Lens%20Finding/Images/best%20model_ROC.png)


### Task 4: Diffusion Model

**Objective**: Generate synthetic gravitational lensing images using advanced generative models.

**Approach**:
- Implemented DDIM (Denoising Diffusion Implicit Models) with U-Net backbone
- Created GAN with Self-Attention mechanisms
- Developed memory-optimized implementations to handle GPU constraints

**Key Results**:
- DDIM achieved better FID score (197.79 vs. 330.26 for GAN)
- GAN with Self-Attention showed slightly higher Inception Score (1.13 vs. 1.09)
- Generated images successfully captured key gravitational lensing features

![DDIM Samples](https://github.com/XAheli/DeepLense_ML4SCI-GSoC25/blob/main/Specific%20Test%20IV%20Diffusion%20Model/DDIM%20Diffusion/Images/DDIM%20Samples.png)

## Results

| Task | Best Model | Key Metrics |
|------|------------|-------------|
| Multi-Class Classification | Ensemble | Accuracy: 91-92%, AUC: 0.94-0.95 |
| Lens Finding | ResNet18 | AUC: 0.98, Recall: 0.95, F1: 0.21 |
| Diffusion Models | DDIM | FID: 197.79, Inception: 1.09 |

---

*This repository contains my submissions for the GSoC 2025 DeepLense evaluation tasks under ML4SCI. For detailed explanations about each implementation, please refer to the README files within each task directory.*
